/*
---
description: HTML+CSS AJAX animated loaders.

license: MIT

copyright: Copyright (c) 2011 by Max Lavrov (lavmax).

authors: Max Lavrov (lavmax)

requires:
  core/1.3.2: '*'

provides: [MUX.Loader, MUX.Loader.Radar]

...
*/

MUX=window.MUX||{};MUX.Loader=new Class({Implements:Options,options:{display:"block",delay:16,id:"",classes:"",run:false},initialize:function(b){this.setOptions(b);this.elem.addClass("mux-loader "+this.options.classes).setStyle("display","none");this.elem.id=this.options.id;var a=this;this.elem.start=function(){a.start.apply(a)};this.elem.stop=function(){a.stop.apply(a)};this.gcCounter=0;if(this.options.run){this.start()}},toElement:function(){return this.elem},_setBackground:function(c,b){var d=";";if(typeof b==="string"){d+="background:"+b+";"}else{if(b instanceof Array){for(var a=0;a<b.length;a++){d+=(/:/.test(b[a])?"":"background:")+b[a]+";"}}}c.style.cssText+=d},__animate:function(){if(this.gcCounter>=500&&(this.elem.getStyle("display")==="hidden"||!this.elem.getParent("body"))){clearInterval(this.intervalId);return}this.gcCounter++;this._animate()},start:function(){var a=this;if(this.intervalId){clearInterval(this.intervalId)}this.elem.setStyle("display",this.options.display);this.intervalId=setInterval(function(){a.__animate.apply(a)},this.options.delay)},stop:function(){this.elem.setStyle("display","none");clearInterval(this.intervalId);this.intervalId=undefined}});MUX.Loader.Radar=new Class({Extends:MUX.Loader,options:{size:16,delay:30,overrun:20,background:["#7db9e8","-moz-linear-gradient(top, #7db9e8 0%, #1E5799 59%)","-webkit-gradient(linear, left top, left bottom, color-stop(0%,#7db9e8), color-stop(59%,#1E5799))",'filter: progid:DXImageTransform.Microsoft.gradient( startColorstr="#7db9e8", endColorstr="#1E5799",GradientType=0 )',"-o-linear-gradient(top, #7db9e8 0%,#1E5799 59%)"],color:"#fff"},initialize:function(a){this.setOptions(a);this.elem=new Element("div",{styles:{height:this.options.size,width:this.options.size,overflow:"hidden","border-radius":Browser.ie?0:(this.options.size.toInt()/2)+"px","-webkit-border-radius":(this.options.size.toInt()/2)+"px","-moz-border-radius":(this.options.size.toInt()/2)+"px"}});if(this.options.size<30){this.runnerWidth=2}else{this.runnerWidth=3}this.shift=-this.runnerWidth;this.runner=new Element("div",{styles:{height:"100%",width:this.runnerWidth,background:this.options.color,"margin-left":this.shift}}).inject(this.elem);this._setBackground(this.elem,this.options.background);this.parent(this.options)},_animate:function(){this.runner.setStyle("margin-left",this.shift);this.shift=(this.shift>=this.options.size+this.options.overrun+this.runnerWidth)?-this.runnerWidth:this.shift+1}});